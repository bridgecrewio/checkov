metadata:
  id: CKV3_SAST_24
  name: Ensure that encryption is not symmetric
  guidelines: Detect usage of symmetric encryptions in code, The use of
    asymmetric encryption is preferred.
  category: sast
  cwe: "CWE-326: Inadequate Encryption Strength"
scope:
  languages:
    - javascript
definition:
  - or:
      - and:
        - cond_type: pattern
          operator: equals
          value: |
            $PACKAGE = require('node-forge');
            ...
            $PACKAGE.cipher.createCipher($ENCRYPTION,...);
        - cond_type: "variable"
          variable: "$ENCRYPTION"
          operator: "regex_match"
          value: "('DES|'3DES)"
      - cond_type: pattern
        operator: equals
        value: CryptoJS.DES.encrypt(...)
      - cond_type: pattern
        operator: equals
        value: CryptoJS.TripleDES.encrypt(...)


