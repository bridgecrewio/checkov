metadata:
  id: CKV3_SAST_23
  name: Ensure that encryption keys are of size 16 bytes or higher
  category: sast
  cwe: "CWE-326: Inadequate Encryption Strength"
scope:
  languages:
    - javascript
definition:
  - or:
      - cond_type: pattern
        operator: equals
        value: |
          import nacl from 'tweetnacl';
          ...
          nacl.randomBytes($KEY_SIZE);
      - cond_type: pattern
        operator: equals
        value: |
          require('randombytes');
          ...
          randomBytes($KEY_SIZE,...)
      - cond_type: pattern
        operator: equals
        value: |
          $PACKAGE = require('node-forge');
          ...
          $PACKAGE.random.getBytesSync($KEY_SIZE);
      - cond_type: pattern
        operator: equals
        value: "cryptoRandomString({..., length: $KEY_SIZE, ...}, ...);"
      - cond_type: pattern
        operator: equals
        value: "cryptoRandomStringAsync({..., length: $KEY_SIZE, ...}, ...);"
      - cond_type: pattern
        operator: equals
        value: |
          $RAND = new brorand.Rand(...);
          ...
          $RAND.generate($KEY_SIZE)
  - cond_type: variable
    variable: $KEY_SIZE
    operator: less_than
    value: 16