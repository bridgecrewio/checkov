metadata:
  id: "CKV2_GCP_1"
  name: "Ensure GKE clusters are not running using the Compute Engine default service account "
  category: "NETWORKING"
definition:
  and:
    - resource_types:
        - google_project_default_service_accounts
      connected_resource_types:
        - google_container_node_pool
      operator:  not_exists
      cond_type: connection
    - resource_types:
        - google_project_default_service_accounts
      connected_resource_types:
        - google_container_cluster
      operator:  not_exists
      cond_type: connection
    - cond_type: filter
      attribute: resource_type
      value:
        - google_project_default_service_accounts
      operator: within

