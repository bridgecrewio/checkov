metadata:
  id: "CKV_GCR_1"
  name: "GCP GCR Container Vulnerability Scanning is enabled"
  guidelines: "This policy identifies GCP accounts where GCR Container Vulnerability Scanning is not enabled. GCR Container Analysis and other third party products allow images stored in GCR to be scanned for known vulnerabilities. Vulnerabilities in software packages can be exploited by hackers or malicious users to obtain unauthorized access to local cloud resources. It is recommended to enable vulnerability scanning for images stored in Google Container Registry."
  category: "SECURITY"
scope:
  provider: "gcp"
definition:
  cond_type: "attribute"
  resource_types:
  - "google_project_services"
  - "google_project_service"
  attribute: "iam_instance_profile"
  operator: "exists"
  or:
    - cond_type: "attribute"
      resource_types:
      - "google_project_services"
      attribute: "services"
      operator: "contains"
      value: "containerscanning.googleapis.com"
    - cond_type: "attribute"
      resource_types:
      - "google_project_service"
      attribute: "service"
      operator: "contains"
      value: "containerscanning.googleapis.com"