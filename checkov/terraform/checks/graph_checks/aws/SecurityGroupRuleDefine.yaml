metadata:
  id: "CKV2_AWS_42"
  name: "Ensure Security Group has Security Group Rule"
  category: "GENERAL_SECURITY"
definition:
  and:
    - cond_type: filter
      attribute: resource_type
      value:
        - aws_security_group
      operator: within
      or:
        - cond_type: attribute
          resource_type: aws_security_group
          attribute: "ingress"
          operator: exists
        - cond_type: attribute
          resource_type: aws_security_group
          attribute: "egress"
          operator: exists
          and:
            - cond_type: attribute
              resource_type: aws_security_group_rule
              operator: within
            - resource_types:
                - aws_security_group_rule
              connected_resource_types:
                - aws_security_group
              operator: exists
              cond_type: connection