metadata:
  id: "CKV2_AWS_3"
  name: "Ensure GuardDuty is enabled to specific org/region"
  category: "GENERAL_SECURITY"
definition:
  and:
    - resource_types:
        - aws_guardduty_detector
      connected_resource_types:
        - aws_guardduty_organization_configuration
      operator:  exists
      cond_type: connection
    - cond_type: "attribute"
      resource_types: 
        - aws_guardduty_organization_configuration
      attribute: auto_enable
      operator: equals
      value: true
    - cond_type: "attribute"
      resource_types: 
        - aws_guardduty_detector
      attribute: enable
      operator: equals
      value: true
    - cond_type: filter
      attribute: resource_type
      value:
        - aws_guardduty_detector
      operator: within

