metadata:
  name: "Ensure that an S3 bucket has a lifecycle configuration"
  category: "LOGGING"
  id: "CKV2_AWS_61"
definition:
  or:
    - and:
        - cond_type: filter
          attribute: resource_type
          operator: within
          value:
            - aws_s3_bucket
        - cond_type: connection
          resource_types:
            - aws_s3_bucket
          connected_resource_types:
            - aws_s3_bucket_lifecycle_configuration
          operator: exists
    - cond_type: attribute
      resource_types:
        - aws_s3_bucket
      attribute: lifecycle_rule
      operator: exists
