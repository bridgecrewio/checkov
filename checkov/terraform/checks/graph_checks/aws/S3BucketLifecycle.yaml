metadata:
  name: "Ensure the S3 bucket has lifecycle configuration"
  category: "GENERAL"
  id: "CKV2_AWS_61"
definition:
    and:
    - cond_type: filter
      attribute: resource_type
      operator: within
      value:
        - aws_s3_bucket
    - cond_type: connection
      resource_types:
        - aws_s3_bucket
      connected_resource_types:
        - aws_s3_bucket_lifecycle_configuration
      operator: exists
