metadata:
  name: "Ensure S3 buckets should have event notifications enabled"
  category: "LOGGING"
  id: "CKV2_AWS_62"
definition:
    and:
    - cond_type: filter
      attribute: resource_type
      operator: within
      value:
        - aws_s3_bucket
    - cond_type: connection
      resource_types:
        - aws_s3_bucket
      connected_resource_types:
        - aws_s3_bucket_notification
      operator: exists
