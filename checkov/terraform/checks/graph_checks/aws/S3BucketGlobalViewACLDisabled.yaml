metadata:
  name: "Ensure AWS S3 bucket has global view ACL permissions disabled"
  id: "CKV2_AWS_57"
  category: "IAM"

definition:
  and:
    - cond_type: "attribute"
      resource_types: "aws_s3_bucket_acl"
      attribute: "access_control_policy.grant[?(@.grantee.uri=='http://acs.amazonaws.com/groups/global/AllUsers')].permission"
      operator: "jsonpath_not_contains"
      value: "READ_ACP"
    - cond_type: "attribute"
      resource_types: "aws_s3_bucket_acl"
      attribute: "access_control_policy.grant[?(@.grantee.uri=='http://acs.amazonaws.com/groups/global/AllUsers')].permission"
      operator: "jsonpath_not_contains"
      value: "FULL_CONTROL"