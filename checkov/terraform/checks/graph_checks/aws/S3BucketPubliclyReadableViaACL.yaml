metadata:
  name: "Ensure AWS S3 buckets are not accessible to public via ACL"
  category: "APPLICATION_SECURITY"
  id: "CKV_AWS_393"
definition:
  and:
    - cond_type: filter
      attribute: resource_type
      operator: within
      value:
        - aws_s3_bucket
    - and:
      - cond_type: connection
        resource_types:
          - aws_s3_bucket
        connected_resource_types:
          - aws_s3_bucket_public_access_block
        operator: exists
      - cond_type: connection
        resource_types:
          - aws_s3_bucket
        connected_resource_types:
          - aws_s3_bucket_website_configuration
        operator: exists
      - cond_type: attribute
        resource_types:
          - aws_s3_bucket_public_access_block
        attribute: block_public_acls
        operator: equals
        value: True