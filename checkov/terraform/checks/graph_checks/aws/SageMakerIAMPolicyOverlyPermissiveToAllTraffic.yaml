metadata:
  id: "CKV2_AWS_70"
  name: "Ensure SageMaker notebook instance IAM policy is not overly permissive"
  category: "NETWORKING"

definition:
  and:
    - cond_type: filter
      value:
        - aws_sagemaker_notebook_instance
      operator: within
      attribute: resource_type
    - cond_type: connection
      resource_types:
        - aws_sagemaker_notebook_instance
      connected_resource_types:
        - aws_iam_role
      operator: exists
    - cond_type: attribute
      resource_types:
        - aws_iam_role
      attribute: "policy.Statement[?(@.Effect == Allow)].Action[*]"
      operator: "jsonpath_not_equals"
      value: "*"

