---
metadata:
  id: "POL_FINAL"
  name: "Ensure AWS IAM policy does not allow actions that permit modification of resource-based policies that can otherwise expose AWS resources to the public."
  category: "IAM"
  severity: "low"
definition:
  or:
    - cond_type: "attribute"
      resource_types:
        - "aws_iam_policy"
        - "aws_iam_role_policy"
        - "aws_iam_group_policy"
        - "aws_iam_user_policy"
      attribute: "policy.Statement[?(@.Effect == Allow)].Action[*]"
      operator: "jsonpath_not_subset"
      value:
        - "acm-pca:CreatePermission"
        - "acm-pca:DeletePermission"
        - "acm-pca:DeletePolicy"
        - "acm-pca:PutPolicy"
        - "apigateway:UpdateRestApiPolicy"
        - "backup:DeleteBackupVaultAccessPolicy"
        - "backup:PutBackupVaultAccessPolicy"
        - "chime:DeleteVoiceConnectorTerminationCredentials"
        - "chime:PutVoiceConnectorTerminationCredentials"
        - "cloudformation:SetStackPolicy"
        - "cloudsearch:UpdateServiceAccessPolicies"
        - "codeartifact:DeleteDomainPermissionsPolicy"
        - "codeartifact:DeleteRepositoryPermissionsPolicy"
        - "codebuild:DeleteResourcePolicy"
        - "codebuild:DeleteSourceCredentials"
        - "codebuild:ImportSourceCredentials"
        - "codebuild:PutResourcePolicy"
        - "codeguru-profiler:PutPermission"
        - "codeguru-profiler:RemovePermission"
        - "codestar:AssociateTeamMember"
        - "codestar:CreateProject"
        - "codestar:DeleteProject"
        - "codestar:DisassociateTeamMember"
        - "codestar:UpdateTeamMember"
        - "cognito-identity:CreateIdentityPool"
        - "cognito-identity:DeleteIdentities"
        - "cognito-identity:DeleteIdentityPool"
        - "cognito-identity:GetId"
        - "cognito-identity:MergeDeveloperIdentities"
        - "cognito-identity:SetIdentityPoolRoles"
        - "cognito-identity:UnlinkDeveloperIdentity"
        - "cognito-identity:UnlinkIdentity"
        - "cognito-identity:UpdateIdentityPool"
        - "deeplens:AssociateServiceRoleToAccount"
        - "ds:CreateConditionalForwarder"
        - "ds:CreateDirectory"
        - "ds:CreateMicrosoftAD"
        - "ds:CreateTrust"
        - "ds:ShareDirectory"
        - "ec2:CreateNetworkInterfacePermission"
        - "ec2:DeleteNetworkInterfacePermission"
        - "ec2:ModifySnapshotAttribute"
        - "ec2:ModifyVpcEndpointServicePermissions"
        - "ec2:ResetSnapshotAttribute"
        - "ecr:DeleteRepositoryPolicy"
        - "ecr:SetRepositoryPolicy"
        - "elasticfilesystem:DeleteFileSystemPolicy"
        - "elasticfilesystem:PutFileSystemPolicy"
        - "elasticmapreduce:PutBlockPublicAccessConfiguration"
        - "es:CreateElasticsearchDomain"
        - "es:UpdateElasticsearchDomainConfig"
        - "glacier:AbortVaultLock"
        - "glacier:CompleteVaultLock"
        - "glacier:DeleteVaultAccessPolicy"
        - "glacier:InitiateVaultLock"
        - "glacier:SetDataRetrievalPolicy"
        - "glacier:SetVaultAccessPolicy"
        - "glue:DeleteResourcePolicy"
        - "glue:PutResourcePolicy"
        - "greengrass:AssociateServiceRoleToAccount"
        - "health:DisableHealthServiceAccessForOrganization"
        - "health:EnableHealthServiceAccessForOrganization"
        - "iam:AddClientIDToOpenIDConnectProvider"
        - "iam:AddRoleToInstanceProfile"
        - "iam:AddUserToGroup"
        - "iam:AttachGroupPolicy"
        - "iam:AttachRolePolicy"
        - "iam:AttachUserPolicy"
        - "iam:ChangePassword"
        - "iam:CreateAccessKey"
        - "iam:CreateAccountAlias"
        - "iam:CreateGroup"
        - "iam:CreateInstanceProfile"
        - "iam:CreateLoginProfile"
        - "iam:CreateOpenIDConnectProvider"
        - "iam:CreatePolicy"
        - "iam:CreatePolicyVersion"
        - "iam:CreateRole"
        - "iam:CreateSAMLProvider"
        - "iam:CreateServiceLinkedRole"
        - "iam:CreateServiceSpecificCredential"
        - "iam:CreateUser"
        - "iam:CreateVirtualMFADevice"
        - "iam:DeactivateMFADevice"
        - "iam:DeleteAccessKey"
        - "iam:DeleteAccountAlias"
        - "iam:DeleteAccountPasswordPolicy"
        - "iam:DeleteGroup"
        - "iam:DeleteGroupPolicy"
        - "iam:DeleteInstanceProfile"
        - "iam:DeleteLoginProfile"
        - "iam:DeleteOpenIDConnectProvider"
        - "iam:DeletePolicy"
        - "iam:DeletePolicyVersion"
        - "iam:DeleteRole"
        - "iam:DeleteRolePermissionsBoundary"
        - "iam:DeleteRolePolicy"
        - "iam:DeleteSAMLProvider"
        - "iam:DeleteSSHPublicKey"
        - "iam:DeleteServerCertificate"
        - "iam:DeleteServiceLinkedRole"
        - "iam:DeleteServiceSpecificCredential"
        - "iam:DeleteSigningCertificate"
        - "iam:DeleteUser"
        - "iam:DeleteUserPermissionsBoundary"
        - "iam:DeleteUserPolicy"
        - "iam:DeleteVirtualMFADevice"
        - "iam:DetachGroupPolicy"
        - "iam:DetachRolePolicy"
        - "iam:DetachUserPolicy"
        - "iam:EnableMFADevice"
        - "iam:PassRole"
        - "iam:PutGroupPolicy"
        - "iam:PutRolePermissionsBoundary"
        - "iam:PutRolePolicy"
        - "iam:PutUserPermissionsBoundary"
        - "iam:PutUserPolicy"
        - "iam:RemoveClientIDFromOpenIDConnectProvider"
        - "iam:RemoveRoleFromInstanceProfile"
        - "iam:RemoveUserFromGroup"
        - "iam:ResetServiceSpecificCredential"
        - "iam:ResyncMFADevice"
        - "iam:SetDefaultPolicyVersion"
        - "iam:SetSecurityTokenServicePreferences"
        - "iam:UpdateAccessKey"
        - "iam:UpdateAccountPasswordPolicy"
        - "iam:UpdateAssumeRolePolicy"
        - "iam:UpdateGroup"
        - "iam:UpdateLoginProfile"
        - "iam:UpdateOpenIDConnectProviderThumbprint"
        - "iam:UpdateRole"
        - "iam:UpdateRoleDescription"
        - "iam:UpdateSAMLProvider"
        - "iam:UpdateSSHPublicKey"
        - "iam:UpdateServerCertificate"
        - "iam:UpdateServiceSpecificCredential"
        - "iam:UpdateSigningCertificate"
        - "iam:UpdateUser"
        - "iam:UploadSSHPublicKey"
        - "iam:UploadServerCertificate"
        - "iam:UploadSigningCertificate"
        - "imagebuilder:PutComponentPolicy"
        - "imagebuilder:PutImagePolicy"
        - "imagebuilder:PutImageRecipePolicy"
        - "iot:AttachPolicy"
        - "iot:AttachPrincipalPolicy"
        - "iot:DetachPolicy"
        - "iot:DetachPrincipalPolicy"
        - "iot:SetDefaultAuthorizer"
        - "iot:SetDefaultPolicyVersion"
        - "iotsitewise:CreateAccessPolicy"
        - "iotsitewise:DeleteAccessPolicy"
        - "iotsitewise:UpdateAccessPolicy"
        - "kms:CreateGrant"
        - "kms:PutKeyPolicy"
        - "kms:RetireGrant"
        - "kms:RevokeGrant"
        - "lakeformation:BatchGrantPermissions"
        - "lakeformation:BatchRevokePermissions"
        - "lakeformation:GrantPermissions"
        - "lakeformation:PutDataLakeSettings"
        - "lakeformation:RevokePermissions"
        - "lambda:AddLayerVersionPermission"
        - "lambda:AddPermission"
        - "lambda:DisableReplication"
        - "lambda:EnableReplication"
        - "lambda:RemoveLayerVersionPermission"
        - "lambda:RemovePermission"
        - "license-manager:UpdateServiceSettings"
        - "lightsail:GetRelationalDatabaseMasterUserPassword"
        - "logs:DeleteResourcePolicy"
        - "logs:PutResourcePolicy"
        - "mediapackage:RotateIngestEndpointCredentials"
        - "mediastore:DeleteContainerPolicy"
        - "mediastore:PutContainerPolicy"
        - "opsworks:SetPermission"
        - "opsworks:UpdateUserProfile"
        - "quicksight:CreateAdmin"
        - "quicksight:CreateGroup"
        - "quicksight:CreateGroupMembership"
        - "quicksight:CreateIAMPolicyAssignment"
        - "quicksight:CreateUser"
        - "quicksight:DeleteGroup"
        - "quicksight:DeleteGroupMembership"
        - "quicksight:DeleteIAMPolicyAssignment"
        - "quicksight:DeleteUser"
        - "quicksight:DeleteUserByPrincipalId"
        - "quicksight:RegisterUser"
        - "quicksight:UpdateDashboardPermissions"
        - "quicksight:UpdateGroup"
        - "quicksight:UpdateIAMPolicyAssignment"
        - "quicksight:UpdateTemplatePermissions"
        - "quicksight:UpdateUser"
        - "ram:AcceptResourceShareInvitation"
        - "ram:AssociateResourceShare"
        - "ram:CreateResourceShare"
        - "ram:DeleteResourceShare"
        - "ram:DisassociateResourceShare"
        - "ram:EnableSharingWithAwsOrganization"
        - "ram:RejectResourceShareInvitation"
        - "ram:UpdateResourceShare"
        - "rds:AuthorizeDBSecurityGroupIngress"
        - "rds-db:connect"
        - "redshift:AuthorizeSnapshotAccess"
        - "redshift:CreateClusterUser"
        - "redshift:CreateSnapshotCopyGrant"
        - "redshift:JoinGroup"
        - "redshift:ModifyClusterIamRoles"
        - "redshift:RevokeSnapshotAccess"
        - "route53resolver:PutResolverRulePolicy"
        - "s3:BypassGovernanceRetention"
        - "s3:DeleteAccessPointPolicy"
        - "s3:DeleteBucketPolicy"
        - "s3:ObjectOwnerOverrideToBucketOwner"
        - "s3:PutAccessPointPolicy"
        - "s3:PutAccountPublicAccessBlock"
        - "s3:PutBucketAcl"
        - "s3:PutBucketPolicy"
        - "s3:PutBucketPublicAccessBlock"
        - "s3:PutObjectAcl"
        - "s3:PutObjectVersionAcl"
        - "secretsmanager:DeleteResourcePolicy"
        - "secretsmanager:PutResourcePolicy"
        - "secretsmanager:ValidateResourcePolicy"
        - "servicecatalog:CreatePortfolioShare"
        - "servicecatalog:DeletePortfolioShare"
        - "sns:AddPermission"
        - "sns:CreateTopic"
        - "sns:RemovePermission"
        - "sns:SetTopicAttributes"
        - "sqs:AddPermission"
        - "sqs:CreateQueue"
        - "sqs:RemovePermission"
        - "sqs:SetQueueAttributes"
        - "ssm:ModifyDocumentPermission"
        - "sso:AssociateDirectory"
        - "sso:AssociateProfile"
        - "sso:CreateApplicationInstance"
        - "sso:CreateApplicationInstanceCertificate"
        - "sso:CreatePermissionSet"
        - "sso:CreateProfile"
        - "sso:CreateTrust"
        - "sso:DeleteApplicationInstance"
        - "sso:DeleteApplicationInstanceCertificate"
        - "sso:DeletePermissionSet"
        - "sso:DeletePermissionsPolicy"
        - "sso:DeleteProfile"
        - "sso:DisassociateDirectory"
        - "sso:DisassociateProfile"
        - "sso:ImportApplicationInstanceServiceProviderMetadata"
        - "sso:PutPermissionsPolicy"
        - "sso:StartSSO"
        - "sso:UpdateApplicationInstanceActiveCertificate"
        - "sso:UpdateApplicationInstanceDisplayData"
        - "sso:UpdateApplicationInstanceResponseConfiguration"
        - "sso:UpdateApplicationInstanceResponseSchemaConfiguration"
        - "sso:UpdateApplicationInstanceSecurityConfiguration"
        - "sso:UpdateApplicationInstanceServiceProviderConfiguration"
        - "sso:UpdateApplicationInstanceStatus"
        - "sso:UpdateDirectoryAssociation"
        - "sso:UpdatePermissionSet"
        - "sso:UpdateProfile"
        - "sso:UpdateSSOConfiguration"
        - "sso:UpdateTrust"
        - "sso-directory:AddMemberToGroup"
        - "sso-directory:CreateAlias"
        - "sso-directory:CreateGroup"
        - "sso-directory:CreateUser"
        - "sso-directory:DeleteGroup"
        - "sso-directory:DeleteUser"
        - "sso-directory:DisableUser"
        - "sso-directory:EnableUser"
        - "sso-directory:RemoveMemberFromGroup"
        - "sso-directory:UpdateGroup"
        - "sso-directory:UpdatePassword"
        - "sso-directory:UpdateUser"
        - "sso-directory:VerifyEmail"
        - "storagegateway:DeleteChapCredentials"
        - "storagegateway:SetLocalConsolePassword"
        - "storagegateway:SetSMBGuestPassword"
        - "storagegateway:UpdateChapCredentials"
        - "waf:DeletePermissionPolicy"
        - "waf:PutPermissionPolicy"
        - "waf-regional:DeletePermissionPolicy"
        - "waf-regional:PutPermissionPolicy"
        - "wafv2:CreateWebACL"
        - "wafv2:DeletePermissionPolicy"
        - "wafv2:DeleteWebACL"
        - "wafv2:PutPermissionPolicy"
        - "wafv2:UpdateWebACL"
        - "worklink:UpdateDevicePolicyConfiguration"
        - "workmail:ResetPassword"
        - "workmail:ResetUserPassword"
        - "xray:PutEncryptionConfig"
        - "apigateway:*"
        - "backup:*"
        - "chime:*"
        - "cloudformation:*"
        - "cloudsearch:*"
        - "codeartifact:*"
        - "codebuild:*"
        - "codeguru-profiler:*"
        - "codestar:*"
        - "cognito-identity:*"
        - "deeplens:*"
        - "ds:*"
        - "ec2:*"
        - "ecr:*"
        - "elasticfilesystem:*"
        - "elasticmapreduce:*"
        - "es:*"
        - "glacier:*"
        - "glue:*"
        - "greengrass:*"
        - "health:*"
        - "iam:*"
        - "imagebuilder:*"
        - "iot:*"
        - "iotsitewise:*"
        - "kms:*"
        - "lakeformation:*"
        - "lambda:*"
        - "license-manager:*"
        - "lightsail:*"
        - "logs:*"
        - "mediapackage:*"
        - "mediastore:*"
        - "opsworks:*"
        - "quicksight:*"
        - "ram:*"
        - "rds:*"
        - "rds-db:*"
        - "redshift:*"
        - "route53resolver:*"
        - "s3:*"
        - "secretsmanager:*"
        - "servicecatalog:*"
        - "sns:*"
        - "sqs:*"
        - "ssm:*"
        - "sso:*"
        - "sso-directory:*"
        - "storagegateway:*"
        - "waf:*"
        - "waf-regional:*"
        - "wafv2:*"
        - "worklink:*"
        - "workmail:*"
        - "xray:*"
        - "acm-pca:Create*"
        - "acm-pca:Delete*"
        - "acm-pca:Put*"
        - "apigateway:Update*"
        - "backup:Delete*"
        - "backup:Put*"
        - "chime:Delete*"
        - "chime:Put*"
        - "cloudformation:Set*"
        - "cloudsearch:Update*"
        - "codeartifact:Delete*"
        - "codebuild:Delete*"
        - "codebuild:Import*"
        - "codebuild:Put*"
        - "codeguru-profiler:Put*"
        - "codeguru-profiler:Remove*"
        - "codestar:Associate*"
        - "codestar:Create*"
        - "codestar:Delete*"
        - "codestar:Disassociate*"
        - "codestar:Update*"
        - "cognito-identity:Create*"
        - "cognito-identity:Delete*"
        - "cognito-identity:Get*"
        - "cognito-identity:Merge*"
        - "cognito-identity:Set*"
        - "cognito-identity:Unlink*"
        - "cognito-identity:Update*"
        - "deeplens:Associate*"
        - "ds:Create*"
        - "ds:Share*"
        - "ec2:Create*"
        - "ec2:Delete*"
        - "ec2:Modify*"
        - "ec2:Reset*"
        - "ecr:Delete*"
        - "ecr:Set*"
        - "elasticfilesystem:Delete*"
        - "elasticfilesystem:Put*"
        - "elasticmapreduce:Put*"
        - "es:Create*"
        - "es:Update*"
        - "glacier:Abort*"
        - "glacier:Complete*"
        - "glacier:Delete*"
        - "glacier:Initiate*"
        - "glacier:Set*"
        - "glue:Delete*"
        - "glue:Put*"
        - "greengrass:Associate*"
        - "health:Disable*"
        - "health:Enable*"
        - "iam:Add*"
        - "iam:Attach*"
        - "iam:Change*"
        - "iam:Create*"
        - "iam:CreatePolicy*"
        - "iam:CreateService*"
        - "iam:Deactivate*"
        - "iam:Delete*"
        - "iam:DeleteAccount*"
        - "iam:DeleteGroup*"
        - "iam:DeletePolicy*"
        - "iam:DeleteRole*"
        - "iam:DeleteService*"
        - "iam:DeleteUser*"
        - "iam:Detach*"
        - "iam:Enable*"
        - "iam:Pass*"
        - "iam:Put*"
        - "iam:PutRole*"
        - "iam:PutUser*"
        - "iam:Remove*"
        - "iam:Reset*"
        - "iam:Resync*"
        - "iam:Set*"
        - "iam:Update*"
        - "iam:UpdateRole*"
        - "iam:Upload*"
        - "imagebuilder:Put*"
        - "imagebuilder:PutImage*"
        - "iot:Attach*"
        - "iot:Detach*"
        - "iot:Set*"
        - "iot:SetDefault*"
        - "iotsitewise:Create*"
        - "iotsitewise:Delete*"
        - "iotsitewise:Update*"
        - "kms:Create*"
        - "kms:Put*"
        - "kms:Retire*"
        - "kms:Revoke*"
        - "lakeformation:Batch*"
        - "lakeformation:Grant*"
        - "lakeformation:Put*"
        - "lakeformation:Revoke*"
        - "lambda:Add*"
        - "lambda:Disable*"
        - "lambda:Enable*"
        - "lambda:Remove*"
        - "license-manager:Update*"
        - "lightsail:Get*"
        - "logs:Delete*"
        - "logs:Put*"
        - "mediapackage:Rotate*"
        - "mediastore:Delete*"
        - "mediastore:Put*"
        - "opsworks:Set*"
        - "opsworks:Update*"
        - "quicksight:Create*"
        - "quicksight:CreateGroup*"
        - "quicksight:Delete*"
        - "quicksight:DeleteGroup*"
        - "quicksight:DeleteUser*"
        - "quicksight:Register*"
        - "quicksight:Update*"
        - "ram:Accept*"
        - "ram:Associate*"
        - "ram:Create*"
        - "ram:Delete*"
        - "ram:Disassociate*"
        - "ram:Enable*"
        - "ram:Reject*"
        - "ram:Update*"
        - "rds:Authorize*"
        - "rds-db:connect*"
        - "redshift:Authorize*"
        - "redshift:Create*"
        - "redshift:Join*"
        - "redshift:Modify*"
        - "redshift:Revoke*"
        - "route53resolver:Put*"
        - "s3:Bypass*"
        - "s3:Delete*"
        - "s3:Object*"
        - "s3:Put*"
        - "s3:PutBucket*"
        - "s3:PutObject*"
        - "secretsmanager:Delete*"
        - "secretsmanager:Put*"
        - "secretsmanager:Validate*"
        - "servicecatalog:Create*"
        - "servicecatalog:Delete*"
        - "sns:Add*"
        - "sns:Create*"
        - "sns:Remove*"
        - "sns:Set*"
        - "sqs:Add*"
        - "sqs:Create*"
        - "sqs:Remove*"
        - "sqs:Set*"
        - "ssm:Modify*"
        - "sso:Associate*"
        - "sso:Create*"
        - "sso:CreateApplicationInstance*"
        - "sso:Delete*"
        - "sso:DeleteApplicationInstance*"
        - "sso:Disassociate*"
        - "sso:Import*"
        - "sso:Put*"
        - "sso:Start*"
        - "sso:Update*"
        - "sso:UpdateApplicationInstance*"
        - "sso:UpdateApplicationInstanceResponse*"
        - "sso-directory:Add*"
        - "sso-directory:Create*"
        - "sso-directory:Delete*"
        - "sso-directory:Disable*"
        - "sso-directory:Enable*"
        - "sso-directory:Remove*"
        - "sso-directory:Update*"
        - "sso-directory:Verify*"
        - "storagegateway:Delete*"
        - "storagegateway:Set*"
        - "storagegateway:Update*"
        - "waf:Delete*"
        - "waf:Put*"
        - "waf-regional:Delete*"
        - "waf-regional:Put*"
        - "wafv2:Create*"
        - "wafv2:Delete*"
        - "wafv2:Put*"
        - "wafv2:Update*"
        - "worklink:Update*"
        - "workmail:Reset*"
        - "xray:Put*"
        - "*"
    - cond_type: "attribute"
      resource_types:
        - "aws_ssoadmin_permission_set_inline_policy"
      attribute: "inline_policy.Statement[?(@.Effect == Allow)].Action[*]"
      operator: "jsonpath_not_subset"
      value:
        - "acm-pca:CreatePermission"
        - "acm-pca:DeletePermission"
        - "acm-pca:DeletePolicy"
        - "acm-pca:PutPolicy"
        - "apigateway:UpdateRestApiPolicy"
        - "backup:DeleteBackupVaultAccessPolicy"
        - "backup:PutBackupVaultAccessPolicy"
        - "chime:DeleteVoiceConnectorTerminationCredentials"
        - "chime:PutVoiceConnectorTerminationCredentials"
        - "cloudformation:SetStackPolicy"
        - "cloudsearch:UpdateServiceAccessPolicies"
        - "codeartifact:DeleteDomainPermissionsPolicy"
        - "codeartifact:DeleteRepositoryPermissionsPolicy"
        - "codebuild:DeleteResourcePolicy"
        - "codebuild:DeleteSourceCredentials"
        - "codebuild:ImportSourceCredentials"
        - "codebuild:PutResourcePolicy"
        - "codeguru-profiler:PutPermission"
        - "codeguru-profiler:RemovePermission"
        - "codestar:AssociateTeamMember"
        - "codestar:CreateProject"
        - "codestar:DeleteProject"
        - "codestar:DisassociateTeamMember"
        - "codestar:UpdateTeamMember"
        - "cognito-identity:CreateIdentityPool"
        - "cognito-identity:DeleteIdentities"
        - "cognito-identity:DeleteIdentityPool"
        - "cognito-identity:GetId"
        - "cognito-identity:MergeDeveloperIdentities"
        - "cognito-identity:SetIdentityPoolRoles"
        - "cognito-identity:UnlinkDeveloperIdentity"
        - "cognito-identity:UnlinkIdentity"
        - "cognito-identity:UpdateIdentityPool"
        - "deeplens:AssociateServiceRoleToAccount"
        - "ds:CreateConditionalForwarder"
        - "ds:CreateDirectory"
        - "ds:CreateMicrosoftAD"
        - "ds:CreateTrust"
        - "ds:ShareDirectory"
        - "ec2:CreateNetworkInterfacePermission"
        - "ec2:DeleteNetworkInterfacePermission"
        - "ec2:ModifySnapshotAttribute"
        - "ec2:ModifyVpcEndpointServicePermissions"
        - "ec2:ResetSnapshotAttribute"
        - "ecr:DeleteRepositoryPolicy"
        - "ecr:SetRepositoryPolicy"
        - "elasticfilesystem:DeleteFileSystemPolicy"
        - "elasticfilesystem:PutFileSystemPolicy"
        - "elasticmapreduce:PutBlockPublicAccessConfiguration"
        - "es:CreateElasticsearchDomain"
        - "es:UpdateElasticsearchDomainConfig"
        - "glacier:AbortVaultLock"
        - "glacier:CompleteVaultLock"
        - "glacier:DeleteVaultAccessPolicy"
        - "glacier:InitiateVaultLock"
        - "glacier:SetDataRetrievalPolicy"
        - "glacier:SetVaultAccessPolicy"
        - "glue:DeleteResourcePolicy"
        - "glue:PutResourcePolicy"
        - "greengrass:AssociateServiceRoleToAccount"
        - "health:DisableHealthServiceAccessForOrganization"
        - "health:EnableHealthServiceAccessForOrganization"
        - "iam:AddClientIDToOpenIDConnectProvider"
        - "iam:AddRoleToInstanceProfile"
        - "iam:AddUserToGroup"
        - "iam:AttachGroupPolicy"
        - "iam:AttachRolePolicy"
        - "iam:AttachUserPolicy"
        - "iam:ChangePassword"
        - "iam:CreateAccessKey"
        - "iam:CreateAccountAlias"
        - "iam:CreateGroup"
        - "iam:CreateInstanceProfile"
        - "iam:CreateLoginProfile"
        - "iam:CreateOpenIDConnectProvider"
        - "iam:CreatePolicy"
        - "iam:CreatePolicyVersion"
        - "iam:CreateRole"
        - "iam:CreateSAMLProvider"
        - "iam:CreateServiceLinkedRole"
        - "iam:CreateServiceSpecificCredential"
        - "iam:CreateUser"
        - "iam:CreateVirtualMFADevice"
        - "iam:DeactivateMFADevice"
        - "iam:DeleteAccessKey"
        - "iam:DeleteAccountAlias"
        - "iam:DeleteAccountPasswordPolicy"
        - "iam:DeleteGroup"
        - "iam:DeleteGroupPolicy"
        - "iam:DeleteInstanceProfile"
        - "iam:DeleteLoginProfile"
        - "iam:DeleteOpenIDConnectProvider"
        - "iam:DeletePolicy"
        - "iam:DeletePolicyVersion"
        - "iam:DeleteRole"
        - "iam:DeleteRolePermissionsBoundary"
        - "iam:DeleteRolePolicy"
        - "iam:DeleteSAMLProvider"
        - "iam:DeleteSSHPublicKey"
        - "iam:DeleteServerCertificate"
        - "iam:DeleteServiceLinkedRole"
        - "iam:DeleteServiceSpecificCredential"
        - "iam:DeleteSigningCertificate"
        - "iam:DeleteUser"
        - "iam:DeleteUserPermissionsBoundary"
        - "iam:DeleteUserPolicy"
        - "iam:DeleteVirtualMFADevice"
        - "iam:DetachGroupPolicy"
        - "iam:DetachRolePolicy"
        - "iam:DetachUserPolicy"
        - "iam:EnableMFADevice"
        - "iam:PassRole"
        - "iam:PutGroupPolicy"
        - "iam:PutRolePermissionsBoundary"
        - "iam:PutRolePolicy"
        - "iam:PutUserPermissionsBoundary"
        - "iam:PutUserPolicy"
        - "iam:RemoveClientIDFromOpenIDConnectProvider"
        - "iam:RemoveRoleFromInstanceProfile"
        - "iam:RemoveUserFromGroup"
        - "iam:ResetServiceSpecificCredential"
        - "iam:ResyncMFADevice"
        - "iam:SetDefaultPolicyVersion"
        - "iam:SetSecurityTokenServicePreferences"
        - "iam:UpdateAccessKey"
        - "iam:UpdateAccountPasswordPolicy"
        - "iam:UpdateAssumeRolePolicy"
        - "iam:UpdateGroup"
        - "iam:UpdateLoginProfile"
        - "iam:UpdateOpenIDConnectProviderThumbprint"
        - "iam:UpdateRole"
        - "iam:UpdateRoleDescription"
        - "iam:UpdateSAMLProvider"
        - "iam:UpdateSSHPublicKey"
        - "iam:UpdateServerCertificate"
        - "iam:UpdateServiceSpecificCredential"
        - "iam:UpdateSigningCertificate"
        - "iam:UpdateUser"
        - "iam:UploadSSHPublicKey"
        - "iam:UploadServerCertificate"
        - "iam:UploadSigningCertificate"
        - "imagebuilder:PutComponentPolicy"
        - "imagebuilder:PutImagePolicy"
        - "imagebuilder:PutImageRecipePolicy"
        - "iot:AttachPolicy"
        - "iot:AttachPrincipalPolicy"
        - "iot:DetachPolicy"
        - "iot:DetachPrincipalPolicy"
        - "iot:SetDefaultAuthorizer"
        - "iot:SetDefaultPolicyVersion"
        - "iotsitewise:CreateAccessPolicy"
        - "iotsitewise:DeleteAccessPolicy"
        - "iotsitewise:UpdateAccessPolicy"
        - "kms:CreateGrant"
        - "kms:PutKeyPolicy"
        - "kms:RetireGrant"
        - "kms:RevokeGrant"
        - "lakeformation:BatchGrantPermissions"
        - "lakeformation:BatchRevokePermissions"
        - "lakeformation:GrantPermissions"
        - "lakeformation:PutDataLakeSettings"
        - "lakeformation:RevokePermissions"
        - "lambda:AddLayerVersionPermission"
        - "lambda:AddPermission"
        - "lambda:DisableReplication"
        - "lambda:EnableReplication"
        - "lambda:RemoveLayerVersionPermission"
        - "lambda:RemovePermission"
        - "license-manager:UpdateServiceSettings"
        - "lightsail:GetRelationalDatabaseMasterUserPassword"
        - "logs:DeleteResourcePolicy"
        - "logs:PutResourcePolicy"
        - "mediapackage:RotateIngestEndpointCredentials"
        - "mediastore:DeleteContainerPolicy"
        - "mediastore:PutContainerPolicy"
        - "opsworks:SetPermission"
        - "opsworks:UpdateUserProfile"
        - "quicksight:CreateAdmin"
        - "quicksight:CreateGroup"
        - "quicksight:CreateGroupMembership"
        - "quicksight:CreateIAMPolicyAssignment"
        - "quicksight:CreateUser"
        - "quicksight:DeleteGroup"
        - "quicksight:DeleteGroupMembership"
        - "quicksight:DeleteIAMPolicyAssignment"
        - "quicksight:DeleteUser"
        - "quicksight:DeleteUserByPrincipalId"
        - "quicksight:RegisterUser"
        - "quicksight:UpdateDashboardPermissions"
        - "quicksight:UpdateGroup"
        - "quicksight:UpdateIAMPolicyAssignment"
        - "quicksight:UpdateTemplatePermissions"
        - "quicksight:UpdateUser"
        - "ram:AcceptResourceShareInvitation"
        - "ram:AssociateResourceShare"
        - "ram:CreateResourceShare"
        - "ram:DeleteResourceShare"
        - "ram:DisassociateResourceShare"
        - "ram:EnableSharingWithAwsOrganization"
        - "ram:RejectResourceShareInvitation"
        - "ram:UpdateResourceShare"
        - "rds:AuthorizeDBSecurityGroupIngress"
        - "rds-db:connect"
        - "redshift:AuthorizeSnapshotAccess"
        - "redshift:CreateClusterUser"
        - "redshift:CreateSnapshotCopyGrant"
        - "redshift:JoinGroup"
        - "redshift:ModifyClusterIamRoles"
        - "redshift:RevokeSnapshotAccess"
        - "route53resolver:PutResolverRulePolicy"
        - "s3:BypassGovernanceRetention"
        - "s3:DeleteAccessPointPolicy"
        - "s3:DeleteBucketPolicy"
        - "s3:ObjectOwnerOverrideToBucketOwner"
        - "s3:PutAccessPointPolicy"
        - "s3:PutAccountPublicAccessBlock"
        - "s3:PutBucketAcl"
        - "s3:PutBucketPolicy"
        - "s3:PutBucketPublicAccessBlock"
        - "s3:PutObjectAcl"
        - "s3:PutObjectVersionAcl"
        - "secretsmanager:DeleteResourcePolicy"
        - "secretsmanager:PutResourcePolicy"
        - "secretsmanager:ValidateResourcePolicy"
        - "servicecatalog:CreatePortfolioShare"
        - "servicecatalog:DeletePortfolioShare"
        - "sns:AddPermission"
        - "sns:CreateTopic"
        - "sns:RemovePermission"
        - "sns:SetTopicAttributes"
        - "sqs:AddPermission"
        - "sqs:CreateQueue"
        - "sqs:RemovePermission"
        - "sqs:SetQueueAttributes"
        - "ssm:ModifyDocumentPermission"
        - "sso:AssociateDirectory"
        - "sso:AssociateProfile"
        - "sso:CreateApplicationInstance"
        - "sso:CreateApplicationInstanceCertificate"
        - "sso:CreatePermissionSet"
        - "sso:CreateProfile"
        - "sso:CreateTrust"
        - "sso:DeleteApplicationInstance"
        - "sso:DeleteApplicationInstanceCertificate"
        - "sso:DeletePermissionSet"
        - "sso:DeletePermissionsPolicy"
        - "sso:DeleteProfile"
        - "sso:DisassociateDirectory"
        - "sso:DisassociateProfile"
        - "sso:ImportApplicationInstanceServiceProviderMetadata"
        - "sso:PutPermissionsPolicy"
        - "sso:StartSSO"
        - "sso:UpdateApplicationInstanceActiveCertificate"
        - "sso:UpdateApplicationInstanceDisplayData"
        - "sso:UpdateApplicationInstanceResponseConfiguration"
        - "sso:UpdateApplicationInstanceResponseSchemaConfiguration"
        - "sso:UpdateApplicationInstanceSecurityConfiguration"
        - "sso:UpdateApplicationInstanceServiceProviderConfiguration"
        - "sso:UpdateApplicationInstanceStatus"
        - "sso:UpdateDirectoryAssociation"
        - "sso:UpdatePermissionSet"
        - "sso:UpdateProfile"
        - "sso:UpdateSSOConfiguration"
        - "sso:UpdateTrust"
        - "sso-directory:AddMemberToGroup"
        - "sso-directory:CreateAlias"
        - "sso-directory:CreateGroup"
        - "sso-directory:CreateUser"
        - "sso-directory:DeleteGroup"
        - "sso-directory:DeleteUser"
        - "sso-directory:DisableUser"
        - "sso-directory:EnableUser"
        - "sso-directory:RemoveMemberFromGroup"
        - "sso-directory:UpdateGroup"
        - "sso-directory:UpdatePassword"
        - "sso-directory:UpdateUser"
        - "sso-directory:VerifyEmail"
        - "storagegateway:DeleteChapCredentials"
        - "storagegateway:SetLocalConsolePassword"
        - "storagegateway:SetSMBGuestPassword"
        - "storagegateway:UpdateChapCredentials"
        - "waf:DeletePermissionPolicy"
        - "waf:PutPermissionPolicy"
        - "waf-regional:DeletePermissionPolicy"
        - "waf-regional:PutPermissionPolicy"
        - "wafv2:CreateWebACL"
        - "wafv2:DeletePermissionPolicy"
        - "wafv2:DeleteWebACL"
        - "wafv2:PutPermissionPolicy"
        - "wafv2:UpdateWebACL"
        - "worklink:UpdateDevicePolicyConfiguration"
        - "workmail:ResetPassword"
        - "workmail:ResetUserPassword"
        - "xray:PutEncryptionConfig"
        - "apigateway:*"
        - "backup:*"
        - "chime:*"
        - "cloudformation:*"
        - "cloudsearch:*"
        - "codeartifact:*"
        - "codebuild:*"
        - "codeguru-profiler:*"
        - "codestar:*"
        - "cognito-identity:*"
        - "deeplens:*"
        - "ds:*"
        - "ec2:*"
        - "ecr:*"
        - "elasticfilesystem:*"
        - "elasticmapreduce:*"
        - "es:*"
        - "glacier:*"
        - "glue:*"
        - "greengrass:*"
        - "health:*"
        - "iam:*"
        - "imagebuilder:*"
        - "iot:*"
        - "iotsitewise:*"
        - "kms:*"
        - "lakeformation:*"
        - "lambda:*"
        - "license-manager:*"
        - "lightsail:*"
        - "logs:*"
        - "mediapackage:*"
        - "mediastore:*"
        - "opsworks:*"
        - "quicksight:*"
        - "ram:*"
        - "rds:*"
        - "rds-db:*"
        - "redshift:*"
        - "route53resolver:*"
        - "s3:*"
        - "secretsmanager:*"
        - "servicecatalog:*"
        - "sns:*"
        - "sqs:*"
        - "ssm:*"
        - "sso:*"
        - "sso-directory:*"
        - "storagegateway:*"
        - "waf:*"
        - "waf-regional:*"
        - "wafv2:*"
        - "worklink:*"
        - "workmail:*"
        - "xray:*"
        - "acm-pca:Create*"
        - "acm-pca:Delete*"
        - "acm-pca:Put*"
        - "apigateway:Update*"
        - "backup:Delete*"
        - "backup:Put*"
        - "chime:Delete*"
        - "chime:Put*"
        - "cloudformation:Set*"
        - "cloudsearch:Update*"
        - "codeartifact:Delete*"
        - "codebuild:Delete*"
        - "codebuild:Import*"
        - "codebuild:Put*"
        - "codeguru-profiler:Put*"
        - "codeguru-profiler:Remove*"
        - "codestar:Associate*"
        - "codestar:Create*"
        - "codestar:Delete*"
        - "codestar:Disassociate*"
        - "codestar:Update*"
        - "cognito-identity:Create*"
        - "cognito-identity:Delete*"
        - "cognito-identity:Get*"
        - "cognito-identity:Merge*"
        - "cognito-identity:Set*"
        - "cognito-identity:Unlink*"
        - "cognito-identity:Update*"
        - "deeplens:Associate*"
        - "ds:Create*"
        - "ds:Share*"
        - "ec2:Create*"
        - "ec2:Delete*"
        - "ec2:Modify*"
        - "ec2:Reset*"
        - "ecr:Delete*"
        - "ecr:Set*"
        - "elasticfilesystem:Delete*"
        - "elasticfilesystem:Put*"
        - "elasticmapreduce:Put*"
        - "es:Create*"
        - "es:Update*"
        - "glacier:Abort*"
        - "glacier:Complete*"
        - "glacier:Delete*"
        - "glacier:Initiate*"
        - "glacier:Set*"
        - "glue:Delete*"
        - "glue:Put*"
        - "greengrass:Associate*"
        - "health:Disable*"
        - "health:Enable*"
        - "iam:Add*"
        - "iam:Attach*"
        - "iam:Change*"
        - "iam:Create*"
        - "iam:CreatePolicy*"
        - "iam:CreateService*"
        - "iam:Deactivate*"
        - "iam:Delete*"
        - "iam:DeleteAccount*"
        - "iam:DeleteGroup*"
        - "iam:DeletePolicy*"
        - "iam:DeleteRole*"
        - "iam:DeleteService*"
        - "iam:DeleteUser*"
        - "iam:Detach*"
        - "iam:Enable*"
        - "iam:Pass*"
        - "iam:Put*"
        - "iam:PutRole*"
        - "iam:PutUser*"
        - "iam:Remove*"
        - "iam:Reset*"
        - "iam:Resync*"
        - "iam:Set*"
        - "iam:Update*"
        - "iam:UpdateRole*"
        - "iam:Upload*"
        - "imagebuilder:Put*"
        - "imagebuilder:PutImage*"
        - "iot:Attach*"
        - "iot:Detach*"
        - "iot:Set*"
        - "iot:SetDefault*"
        - "iotsitewise:Create*"
        - "iotsitewise:Delete*"
        - "iotsitewise:Update*"
        - "kms:Create*"
        - "kms:Put*"
        - "kms:Retire*"
        - "kms:Revoke*"
        - "lakeformation:Batch*"
        - "lakeformation:Grant*"
        - "lakeformation:Put*"
        - "lakeformation:Revoke*"
        - "lambda:Add*"
        - "lambda:Disable*"
        - "lambda:Enable*"
        - "lambda:Remove*"
        - "license-manager:Update*"
        - "lightsail:Get*"
        - "logs:Delete*"
        - "logs:Put*"
        - "mediapackage:Rotate*"
        - "mediastore:Delete*"
        - "mediastore:Put*"
        - "opsworks:Set*"
        - "opsworks:Update*"
        - "quicksight:Create*"
        - "quicksight:CreateGroup*"
        - "quicksight:Delete*"
        - "quicksight:DeleteGroup*"
        - "quicksight:DeleteUser*"
        - "quicksight:Register*"
        - "quicksight:Update*"
        - "ram:Accept*"
        - "ram:Associate*"
        - "ram:Create*"
        - "ram:Delete*"
        - "ram:Disassociate*"
        - "ram:Enable*"
        - "ram:Reject*"
        - "ram:Update*"
        - "rds:Authorize*"
        - "rds-db:connect*"
        - "redshift:Authorize*"
        - "redshift:Create*"
        - "redshift:Join*"
        - "redshift:Modify*"
        - "redshift:Revoke*"
        - "route53resolver:Put*"
        - "s3:Bypass*"
        - "s3:Delete*"
        - "s3:Object*"
        - "s3:Put*"
        - "s3:PutBucket*"
        - "s3:PutObject*"
        - "secretsmanager:Delete*"
        - "secretsmanager:Put*"
        - "secretsmanager:Validate*"
        - "servicecatalog:Create*"
        - "servicecatalog:Delete*"
        - "sns:Add*"
        - "sns:Create*"
        - "sns:Remove*"
        - "sns:Set*"
        - "sqs:Add*"
        - "sqs:Create*"
        - "sqs:Remove*"
        - "sqs:Set*"
        - "ssm:Modify*"
        - "sso:Associate*"
        - "sso:Create*"
        - "sso:CreateApplicationInstance*"
        - "sso:Delete*"
        - "sso:DeleteApplicationInstance*"
        - "sso:Disassociate*"
        - "sso:Import*"
        - "sso:Put*"
        - "sso:Start*"
        - "sso:Update*"
        - "sso:UpdateApplicationInstance*"
        - "sso:UpdateApplicationInstanceResponse*"
        - "sso-directory:Add*"
        - "sso-directory:Create*"
        - "sso-directory:Delete*"
        - "sso-directory:Disable*"
        - "sso-directory:Enable*"
        - "sso-directory:Remove*"
        - "sso-directory:Update*"
        - "sso-directory:Verify*"
        - "storagegateway:Delete*"
        - "storagegateway:Set*"
        - "storagegateway:Update*"
        - "waf:Delete*"
        - "waf:Put*"
        - "waf-regional:Delete*"
        - "waf-regional:Put*"
        - "wafv2:Create*"
        - "wafv2:Delete*"
        - "wafv2:Put*"
        - "wafv2:Update*"
        - "worklink:Update*"
        - "workmail:Reset*"
        - "xray:Put*"
        - "*"