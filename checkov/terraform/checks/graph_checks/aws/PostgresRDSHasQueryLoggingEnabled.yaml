metadata:
  name: "Ensure Postgres RDS as aws_rds_cluster has Query Logging enabled"
  id: "CKV2_AWS_27"
  category: "LOGGING"
definition:
 and:
 - cond_type: filter
   attribute: resource_type
   value:
   - aws_rds_cluster
   operator: within
 - cond_type: filter
   resource_types:
   - aws_rds_cluster
   attribute: engine
   operator: within
   value: "aurora-postgresql"
 - cond_type: connection
   resource_types:
   - aws_rds_cluster
   connected_resource_types:
   - aws_rds_cluster_parameter_group
   operator: exists
 - cond_type: attribute
   resource_types:
   - aws_rds_cluster_parameter_group
   attribute: "parameter.*.name"
   operator: contains
   value: "log_statement"  
 - cond_type: attribute
   resource_types:
   - aws_rds_cluster_parameter_group
   attribute: "parameter.*.name"
   operator: contains
   value: "log_min_duration_statement" 