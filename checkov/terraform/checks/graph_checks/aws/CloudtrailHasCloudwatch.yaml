metadata:
  name: "Ensure CloudTrail trails are integrated with CloudWatch Logs"
  id: "CKV2_AWS_10"
  category: "LOGGING"
definition:
    and:
      - cond_type: filter
        attribute: resource_type
        value:
          - aws_cloudtrail
        operator: within
      - cond_type: connection
        resource_types:
           - aws_cloudtrail
        connected_resource_types:
           - aws_cloudwatch_log_group
        operator: exists
      - cond_type: attribute
        resource_types:
           - aws_cloudtrail
        attribute: cloud_watch_logs_group_arn
        operator: exists