metadata:
  id: "CKV2_AWS_1"
  name: "Ensure that all NACL are attached to subnets"
  category: "NETWORKING"
definition:
  or:
    - and :
      - resource_types:
          - aws_network_acl
        connected_resource_types:
          - aws_vpc
        operator:  exists
        attribute: networking
        cond_type: connection
      - resource_types:
          - aws_subnet
        connected_resource_types:
          - aws_vpc
        operator:  exists
        attribute: networking
        cond_type: connection
      - cond_type: filter
        attribute: resource_type
        value:
            - aws_vpc
        operator: within
    - and : 
      - resource_types:
          - aws_network_acl
        connected_resource_types:
          - aws_subnet
        operator:  exists
        attribute: networking
        cond_type: connection
      - cond_type: attribute
        resource_types: 
          - aws_network_acl
        attribute: subnet_ids
        operator: exists
      - cond_type: filter
        attribute: resource_type
        value:
            - aws_network_acl
        operator: within

