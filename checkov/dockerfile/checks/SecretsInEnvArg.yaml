metadata:
  id: CKV_DOCKER_1005
  name: Secrets in ENV or ARG
  category: SECRETS
  severity: HIGH
  description: >
    Detects hardcoded secrets, API keys, tokens, and passwords in Dockerfile
    ENV and ARG instructions. Hardcoded secrets can be extracted from image layers
    or logs and lead to unauthorized access to systems and APIs.
  remediation: >
    Use Docker build-time secrets or external secret managers like AWS Secrets Manager,
    GCP Secret Manager, or HashiCorp Vault. Avoid embedding secrets in Dockerfiles.
    Avoid embedding secrets in Dockerfiles. Use Docker BuildKit secrets or
    external secret managers like AWS Secrets Manager, GCP Secret Manager,
    or HashiCorp Vault.
    See: https://docs.docker.com/build/buildkit/secrets/
