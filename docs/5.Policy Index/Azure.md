---
layout: default
published: true
title: Azure
order: 2
---
|     | Id           | Type              | Entity                                                                       | Policy                                                                                                                                                                                                   | IaC            |
|-----|--------------|-------------------|------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------|
| 199 | CKV_AZURE_1  | resource          | azurerm_linux_virtual_machine                                                | Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)                                                                                                                             | Terraform      |
| 200 | CKV_AZURE_1  | resource          | Microsoft.Compute/virtualMachines                                            | Ensure Azure Instance does not use basic authentication(Use SSH Key Instead)                                                                                                                             | arm            |
| 201 | CKV_AZURE_2  | resource          | azurerm_managed_disk                                                         | Ensure Azure managed disk have encryption enabled                                                                                                                                                        | Terraform      |
| 202 | CKV_AZURE_2  | resource          | Microsoft.Compute/disks                                                      | Ensure Azure managed disk have encryption enabled                                                                                                                                                        | arm            |
| 203 | CKV_AZURE_3  | resource          | azurerm_storage_account                                                      | Ensure that 'Secure transfer required' is set to 'Enabled'                                                                                                                                               | Terraform      |
| 204 | CKV_AZURE_3  | resource          | Microsoft.Storage/storageAccounts                                            | Ensure that 'supportsHttpsTrafficOnly' is set to 'true'                                                                                                                                                  | arm            |
| 205 | CKV_AZURE_4  | resource          | azurerm_kubernetes_cluster                                                   | Ensure AKS logging to Azure Monitoring is Configured                                                                                                                                                     | Terraform      |
| 206 | CKV_AZURE_4  | resource          | Microsoft.ContainerService/managedClusters                                   | Ensure AKS logging to Azure Monitoring is Configured                                                                                                                                                     | arm            |
| 207 | CKV_AZURE_5  | resource          | azurerm_kubernetes_cluster                                                   | Ensure RBAC is enabled on AKS clusters                                                                                                                                                                   | Terraform      |
| 208 | CKV_AZURE_5  | resource          | Microsoft.ContainerService/managedClusters                                   | Ensure RBAC is enabled on AKS clusters                                                                                                                                                                   | arm            |
| 209 | CKV_AZURE_6  | resource          | azurerm_kubernetes_cluster                                                   | Ensure AKS has an API Server Authorized IP Ranges enabled                                                                                                                                                | Terraform      |
| 210 | CKV_AZURE_6  | resource          | Microsoft.ContainerService/managedClusters                                   | Ensure AKS has an API Server Authorized IP Ranges enabled                                                                                                                                                | arm            |
| 211 | CKV_AZURE_7  | resource          | azurerm_kubernetes_cluster                                                   | Ensure AKS cluster has Network Policy configured                                                                                                                                                         | Terraform      |
| 212 | CKV_AZURE_7  | resource          | Microsoft.ContainerService/managedClusters                                   | Ensure AKS cluster has Network Policy configured                                                                                                                                                         | arm            |
| 213 | CKV_AZURE_8  | resource          | azurerm_kubernetes_cluster                                                   | Ensure Kube Dashboard is disabled                                                                                                                                                                        | Terraform      |
| 214 | CKV_AZURE_8  | resource          | Microsoft.ContainerService/managedClusters                                   | Ensure Kubernetes Dashboard is disabled                                                                                                                                                                  | arm            |
| 215 | CKV_AZURE_9  | resource          | azurerm_network_security_rule                                                | Ensure that RDP access is restricted from the internet                                                                                                                                                   | Terraform      |
| 216 | CKV_AZURE_9  | resource          | azurerm_network_security_group                                               | Ensure that RDP access is restricted from the internet                                                                                                                                                   | Terraform      |
| 217 | CKV_AZURE_9  | resource          | Microsoft.Network/networkSecurityGroups                                      | Ensure that RDP access is restricted from the internet                                                                                                                                                   | arm            |
| 218 | CKV_AZURE_9  | resource          | Microsoft.Network/networkSecurityGroups/securityRules                        | Ensure that RDP access is restricted from the internet                                                                                                                                                   | arm            |
| 219 | CKV_AZURE_10 | resource          | azurerm_network_security_rule                                                | Ensure that SSH access is restricted from the internet                                                                                                                                                   | Terraform      |
| 220 | CKV_AZURE_10 | resource          | azurerm_network_security_group                                               | Ensure that SSH access is restricted from the internet                                                                                                                                                   | Terraform      |
| 221 | CKV_AZURE_10 | resource          | Microsoft.Network/networkSecurityGroups                                      | Ensure that SSH access is restricted from the internet                                                                                                                                                   | arm            |
| 222 | CKV_AZURE_10 | resource          | Microsoft.Network/networkSecurityGroups/securityRules                        | Ensure that SSH access is restricted from the internet                                                                                                                                                   | arm            |
| 223 | CKV_AZURE_11 | resource          | azurerm_mariadb_firewall_rule                                                | Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)                                                                                                                                            | Terraform      |
| 224 | CKV_AZURE_11 | resource          | azurerm_sql_firewall_rule                                                    | Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)                                                                                                                                            | Terraform      |
| 225 | CKV_AZURE_11 | resource          | azurerm_postgresql_firewall_rule                                             | Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)                                                                                                                                            | Terraform      |
| 226 | CKV_AZURE_11 | resource          | azurerm_mysql_firewall_rule                                                  | Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)                                                                                                                                            | Terraform      |
| 227 | CKV_AZURE_11 | resource          | Microsoft.Sql/servers                                                        | Ensure no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)                                                                                                                                            | arm            |
| 228 | CKV_AZURE_12 | resource          | azurerm_network_watcher_flow_log                                             | Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'                                                                                                                   | Terraform      |
| 229 | CKV_AZURE_12 | resource          | Microsoft.Network/networkWatchers/flowLogs                                   | Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'                                                                                                                   | arm            |
| 230 | CKV_AZURE_12 | resource          | Microsoft.Network/networkWatchers/FlowLogs                                   | Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'                                                                                                                   | arm            |
| 231 | CKV_AZURE_12 | resource          | Microsoft.Network/networkWatchers/flowLogs/                                  | Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'                                                                                                                   | arm            |
| 232 | CKV_AZURE_12 | resource          | Microsoft.Network/networkWatchers/FlowLogs/                                  | Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'                                                                                                                   | arm            |
| 233 | CKV_AZURE_13 | resource          | azurerm_app_service                                                          | Ensure App Service Authentication is set on Azure App Service                                                                                                                                            | Terraform      |
| 234 | CKV_AZURE_13 | resource          | Microsoft.Web/sites/config                                                   | Ensure App Service Authentication is set on Azure App Service                                                                                                                                            | arm            |
| 235 | CKV_AZURE_13 | resource          | config                                                                       | Ensure App Service Authentication is set on Azure App Service                                                                                                                                            | arm            |
| 236 | CKV_AZURE_14 | resource          | azurerm_app_service                                                          | Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service                                                                                                                                  | Terraform      |
| 237 | CKV_AZURE_14 | resource          | Microsoft.Web/sites                                                          | Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service                                                                                                                                  | arm            |
| 238 | CKV_AZURE_15 | resource          | azurerm_app_service                                                          | Ensure web app is using the latest version of TLS encryption                                                                                                                                             | Terraform      |
| 239 | CKV_AZURE_15 | resource          | Microsoft.Web/sites                                                          | Ensure web app is using the latest version of TLS encryption                                                                                                                                             | arm            |
| 240 | CKV_AZURE_16 | resource          | azurerm_app_service                                                          | Ensure that Register with Azure Active Directory is enabled on App Service                                                                                                                               | Terraform      |
| 241 | CKV_AZURE_16 | resource          | Microsoft.Web/sites                                                          | Ensure that Register with Azure Active Directory is enabled on App Service                                                                                                                               | arm            |
| 242 | CKV_AZURE_17 | resource          | azurerm_app_service                                                          | Ensure the web app has 'Client Certificates (Incoming client certificates)' set                                                                                                                          | Terraform      |
| 243 | CKV_AZURE_17 | resource          | Microsoft.Web/sites                                                          | Ensure the web app has 'Client Certificates (Incoming client certificates)' set                                                                                                                          | arm            |
| 244 | CKV_AZURE_18 | resource          | azurerm_app_service                                                          | Ensure that 'HTTP Version' is the latest if used to run the web app                                                                                                                                      | Terraform      |
| 245 | CKV_AZURE_18 | resource          | Microsoft.Web/sites                                                          | Ensure that 'HTTP Version' is the latest if used to run the web app                                                                                                                                      | arm            |
| 246 | CKV_AZURE_19 | resource          | azurerm_security_center_subscription_pricing                                 | Ensure that standard pricing tier is selected                                                                                                                                                            | Terraform      |
| 247 | CKV_AZURE_19 | resource          | Microsoft.Security/pricings                                                  | Ensure that standard pricing tier is selected                                                                                                                                                            | arm            |
| 248 | CKV_AZURE_20 | resource          | azurerm_security_center_contact                                              | Ensure that security contact 'Phone number' is set                                                                                                                                                       | Terraform      |
| 249 | CKV_AZURE_20 | resource          | Microsoft.Security/securityContacts                                          | Ensure that security contact 'Phone number' is set                                                                                                                                                       | arm            |
| 250 | CKV_AZURE_21 | resource          | azurerm_security_center_contact                                              | Ensure that 'Send email notification for high severity alerts' is set to 'On'                                                                                                                            | Terraform      |
| 251 | CKV_AZURE_21 | resource          | Microsoft.Security/securityContacts                                          | Ensure that 'Send email notification for high severity alerts' is set to 'On'                                                                                                                            | arm            |
| 252 | CKV_AZURE_22 | resource          | azurerm_security_center_contact                                              | Ensure that 'Send email notification for high severity alerts' is set to 'On'                                                                                                                            | Terraform      |
| 253 | CKV_AZURE_22 | resource          | Microsoft.Security/securityContacts                                          | Ensure that 'Send email notification for high severity alerts' is set to 'On'                                                                                                                            | arm            |
| 254 | CKV_AZURE_23 | resource          | azurerm_sql_server                                                           | Ensure that 'Auditing' is set to 'On' for SQL servers                                                                                                                                                    | Terraform      |
| 255 | CKV_AZURE_23 | resource          | azurerm_mssql_server                                                         | Ensure that 'Auditing' is set to 'On' for SQL servers                                                                                                                                                    | Terraform      |
| 256 | CKV_AZURE_23 | resource          | Microsoft.Sql/servers                                                        | Ensure that 'Auditing' is set to 'Enabled' for SQL servers                                                                                                                                               | arm            |
| 257 | CKV_AZURE_24 | resource          | azurerm_sql_server                                                           | Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers                                                                                                                               | Terraform      |
| 258 | CKV_AZURE_24 | resource          | azurerm_mssql_server                                                         | Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers                                                                                                                               | Terraform      |
| 259 | CKV_AZURE_24 | resource          | Microsoft.Sql/servers                                                        | Ensure that 'Auditing' Retention is 'greater than 90 days' for SQL servers                                                                                                                               | arm            |
| 260 | CKV_AZURE_25 | resource          | azurerm_mssql_server_security_alert_policy                                   | Ensure that 'Threat Detection types' is set to 'All'                                                                                                                                                     | Terraform      |
| 261 | CKV_AZURE_25 | resource          | Microsoft.Sql/servers/databases                                              | Ensure that 'Threat Detection types' is set to 'All'                                                                                                                                                     | arm            |
| 262 | CKV_AZURE_26 | resource          | azurerm_mssql_server_security_alert_policy                                   | Ensure that 'Send Alerts To' is enabled for MSSQL servers                                                                                                                                                | Terraform      |
| 263 | CKV_AZURE_26 | resource          | Microsoft.Sql/servers/databases                                              | Ensure that 'Send Alerts To' is enabled for MSSQL servers                                                                                                                                                | arm            |
| 264 | CKV_AZURE_27 | resource          | azurerm_mssql_server_security_alert_policy                                   | Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers                                                                                                                         | Terraform      |
| 265 | CKV_AZURE_27 | resource          | Microsoft.Sql/servers/databases                                              | Ensure that 'Email service and co-administrators' is 'Enabled' for MSSQL servers                                                                                                                         | arm            |
| 266 | CKV_AZURE_28 | resource          | azurerm_mysql_server                                                         | Ensure 'Enforce SSL connection' is set to 'ENABLED' for MySQL Database Server                                                                                                                            | Terraform      |
| 267 | CKV_AZURE_28 | resource          | Microsoft.DBforMySQL/servers                                                 | Ensure 'Enforce SSL connection' is set to 'ENABLED' for MySQL Database Server                                                                                                                            | arm            |
| 268 | CKV_AZURE_29 | resource          | azurerm_postgresql_server                                                    | Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server                                                                                                                       | Terraform      |
| 269 | CKV_AZURE_29 | resource          | Microsoft.DBforPostgreSQL/servers                                            | Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server                                                                                                                       | arm            |
| 270 | CKV_AZURE_30 | resource          | azurerm_postgresql_configuration                                             | Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server                                                                                                                  | Terraform      |
| 271 | CKV_AZURE_30 | resource          | Microsoft.DBforPostgreSQL/servers/configurations                             | Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server                                                                                                                  | arm            |
| 272 | CKV_AZURE_30 | resource          | configurations                                                               | Ensure server parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server                                                                                                                  | arm            |
| 273 | CKV_AZURE_31 | resource          | azurerm_postgresql_configuration                                             | Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server                                                                                                                  | Terraform      |
| 274 | CKV_AZURE_31 | resource          | Microsoft.DBforPostgreSQL/servers/configurations                             | Ensure configuration 'log_connections' is set to 'ON' for PostgreSQL Database Server                                                                                                                     | arm            |
| 275 | CKV_AZURE_31 | resource          | configurations                                                               | Ensure configuration 'log_connections' is set to 'ON' for PostgreSQL Database Server                                                                                                                     | arm            |
| 276 | CKV_AZURE_32 | resource          | azurerm_postgresql_configuration                                             | Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server                                                                                                            | Terraform      |
| 277 | CKV_AZURE_32 | resource          | Microsoft.DBforPostgreSQL/servers/configurations                             | Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server                                                                                                            | arm            |
| 278 | CKV_AZURE_32 | resource          | configurations                                                               | Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server                                                                                                            | arm            |
| 279 | CKV_AZURE_33 | resource          | azurerm_storage_account                                                      | Ensure Storage logging is enabled for Queue service for read, write and delete requests                                                                                                                  | Terraform      |
| 280 | CKV_AZURE_33 | resource          | Microsoft.Storage/storageAccounts/queueServices/providers/diagnosticsettings | Ensure Storage logging is enabled for Queue service for read, write and delete requests                                                                                                                  | arm            |
| 281 | CKV_AZURE_34 | resource          | azurerm_storage_container                                                    | Ensure that 'Public access level' is set to Private for blob containers                                                                                                                                  | Terraform      |
| 282 | CKV_AZURE_34 | resource          | Microsoft.Storage/storageAccounts/blobServices/containers                    | Ensure that 'Public access level' is set to Private for blob containers                                                                                                                                  | arm            |
| 283 | CKV_AZURE_34 | resource          | containers                                                                   | Ensure that 'Public access level' is set to Private for blob containers                                                                                                                                  | arm            |
| 284 | CKV_AZURE_34 | resource          | blobServices/containers                                                      | Ensure that 'Public access level' is set to Private for blob containers                                                                                                                                  | arm            |
| 285 | CKV_AZURE_35 | resource          | azurerm_storage_account                                                      | Ensure default network access rule for Storage Accounts is set to deny                                                                                                                                   | Terraform      |
| 286 | CKV_AZURE_35 | resource          | azurerm_storage_account_network_rules                                        | Ensure default network access rule for Storage Accounts is set to deny                                                                                                                                   | Terraform      |
| 287 | CKV_AZURE_35 | resource          | Microsoft.Storage/storageAccounts                                            | Ensure default network access rule for Storage Accounts is set to deny                                                                                                                                   | arm            |
| 288 | CKV_AZURE_36 | resource          | azurerm_storage_account                                                      | Ensure 'Trusted Microsoft Services' is enabled for Storage Account access                                                                                                                                | Terraform      |
| 289 | CKV_AZURE_36 | resource          | azurerm_storage_account_network_rules                                        | Ensure 'Trusted Microsoft Services' is enabled for Storage Account access                                                                                                                                | Terraform      |
| 290 | CKV_AZURE_36 | resource          | Microsoft.Storage/storageAccounts                                            | Ensure 'Trusted Microsoft Services' is enabled for Storage Account access                                                                                                                                | arm            |
| 291 | CKV_AZURE_37 | resource          | azurerm_monitor_log_profile                                                  | Ensure that Activity Log Retention is set 365 days or greater                                                                                                                                            | Terraform      |
| 292 | CKV_AZURE_37 | resource          | microsoft.insights/logprofiles                                               | Ensure that Activity Log Retention is set 365 days or greater                                                                                                                                            | arm            |
| 293 | CKV_AZURE_38 | resource          | azurerm_monitor_log_profile                                                  | Ensure audit profile captures all the activities                                                                                                                                                         | Terraform      |
| 294 | CKV_AZURE_38 | resource          | microsoft.insights/logprofiles                                               | Ensure audit profile captures all the activities                                                                                                                                                         | arm            |
| 295 | CKV_AZURE_39 | resource          | azurerm_role_definition                                                      | Ensure that no custom subscription owner roles are created                                                                                                                                               | Terraform      |
| 296 | CKV_AZURE_39 | resource          | Microsoft.Authorization/roleDefinitions                                      | Ensure that no custom subscription owner roles are created                                                                                                                                               | arm            |
| 297 | CKV_AZURE_40 | resource          | azurerm_key_vault_key                                                        | Ensure that the expiration date is set on all keys                                                                                                                                                       | Terraform      |
| 298 | CKV_AZURE_41 | resource          | azurerm_key_vault_secret                                                     | Ensure that the expiration date is set on all secrets                                                                                                                                                    | Terraform      |
| 299 | CKV_AZURE_41 | resource          | Microsoft.KeyVault/vaults/secrets                                            | Ensure that the expiration date is set on all secrets                                                                                                                                                    | arm            |
| 300 | CKV_AZURE_42 | resource          | azurerm_key_vault                                                            | Ensure the key vault is recoverable                                                                                                                                                                      | Terraform      |
| 301 | CKV_AZURE_42 | resource          | Microsoft.KeyVault/vaults                                                    | Ensure the key vault is recoverable                                                                                                                                                                      | arm            |
| 302 | CKV_AZURE_43 | resource          | azurerm_storage_account                                                      | Ensure the Storage Account naming rules                                                                                                                                                                  | Terraform      |
| 303 | CKV_AZURE_44 | resource          | azurerm_storage_account                                                      | Ensure Storage Account is using the latest version of TLS encryption                                                                                                                                     | Terraform      |
| 304 | CKV_AZURE_45 | resource          | azurerm_virtual_machine                                                      | Ensure that no sensitive credentials are exposed in VM custom_data                                                                                                                                       | Terraform      |
| 305 | CKV_AZURE_46 | resource          | azurerm_mssql_database_extended_auditing_policy                              | Specifies a retention period of less than 90 days.                                                                                                                                                       | Terraform      |
| 306 | CKV_AZURE_47 | resource          | azurerm_mariadb_server                                                       | Ensure 'Enforce SSL connection' is set to 'ENABLED' for MariaDB servers                                                                                                                                  | Terraform      |
| 307 | CKV_AZURE_48 | resource          | azurerm_mariadb_server                                                       | Ensure 'public network access enabled' is set to 'False' for MariaDB servers                                                                                                                             | Terraform      |
| 308 | CKV_AZURE_49 | resource          | azurerm_linux_virtual_machine_scale_set                                      | Ensure Azure linux scale set does not use basic authentication(Use SSH Key Instead)                                                                                                                      | Terraform      |
| 309 | CKV_AZURE_50 | resource          | azurerm_virtual_machine                                                      | Ensure Virtual Machine Extensions are not Installed                                                                                                                                                      | Terraform      |
| 310 | CKV_AZURE_50 | resource          | azurerm_linux_virtual_machine                                                | Ensure Virtual Machine Extensions are not Installed                                                                                                                                                      | Terraform      |
| 311 | CKV_AZURE_51 | resource          | azurerm_managed_disk                                                         | Ensure Disks are encrypted at rest                                                                                                                                                                       | Terraform      |
| 312 | CKV_AZURE_52 | resource          | azurerm_mssql_server                                                         | Ensure MSSQL is using the latest version of TLS encryption                                                                                                                                               | Terraform      |
| 313 | CKV_AZURE_53 | resource          | azurerm_mysql_server                                                         | Ensure 'public network access enabled' is set to 'False' for mySQL servers                                                                                                                               | Terraform      |
| 314 | CKV_AZURE_54 | resource          | azurerm_mysql_server                                                         | Ensure MySQL is using the latest version of TLS encryption                                                                                                                                               | Terraform      |
