resources:
- repo: self

trigger:
- master

stages:
- stage: Example
  jobs:
  - job: PassDefineSettableVariables
    pool:
      vmImage: 'ubuntu-18.04'

    container: ubuntu

    steps:
      - bash: |
          echo "##vso[task.setvariable variable=power;issecret=false]something"
        target:
          settableVariables:
          - power
      - powershell: |
          Write-Host "##vso[task.setvariable variable=sauce;issecret=false]something"
        target:
          settableVariables:
            - sauce
  - job: UnknownNoBashOrPowershell
    pool:
      vmImage: 'ubuntu-18.04'

    container: ubuntu@sha256:a0a45bd8c6c4acd6967396366f01f2a68f73406327285edc5b7b07cb1cf073db

jobs:
- job: FailDoNotDefineSettableVariables
  pool:
    vmImage: 'ubuntu-20.04'
  steps:
  - bash: |
      echo "##vso[task.setvariable variable=normal_variable;]something"
      echo "##vso[task.setvariable variable=secret_variable;issecret=true]super-secret"
    name: setSecretVariableStep
  - powershell: |
      Write-Host "##vso[task.setvariable variable=normal_variable;]something"
      Write-Host "##vso[task.setvariable variable=secret_variable;issecret=true]super-secret"

- job: FailDoNotDefineSettableVariables2
  pool:
    vmImage: 'ubuntu-20.04'
  steps:
  - bash: |
      echo "##vso[task.setvariable variable=normal_variable;]something"
  - powershell: |
      Write-Host "##vso[task.setvariable variable=normal_variable;]something"
