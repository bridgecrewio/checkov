metadata:
  id: "CKV_K8S_XXX"
  name: "ClusterRoleBinding should not allow privilege escalation to a ServiceAccount or Node on other ClusterRoleBinding"
  category: "KUBERNETES"
  # TODO fill
definition:
  and:
    - cond_type: filter
      value:
        - ClusterRoleBinding
      operator: within
      attribute: kind
    - cond_type: connection  # Filter ClusterRoleBiding with connection to ClusterRole
      operator: exists
      resource_types:
        - ClusterRole
      connected_resource_types:
        - ClusterRoleBinding
    - cond_type: attribute  # Make sure ClusterRole does not contain `clusterrolebindings` in `rule.resources`
      operator: not_contains
      attribute: rules.resources
      value: 'clusterrolebindings'
      resource_types:
        - ClusterRole