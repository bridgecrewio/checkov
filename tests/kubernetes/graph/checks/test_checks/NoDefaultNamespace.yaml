metadata:
  id: "CKV_K8S_160"
  name: "Ensure resources in k8s not in default namespace"
  category: "KUBERNETES"
definition:
  and:
    - cond_type: "attribute"
      resource_types:
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
        - "Pod"
        - "Service"
        - "ConfigMap"
        - "Secret"
      attribute: "metadata.namespace"
      operator: "exists"
    - cond_type: "attribute"
      resource_types:
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
        - "Pod"
        - "Service"
        - "ConfigMap"
        - "Secret"
      attribute: "metadata.namespace"
      operator: "not_equals"
      value: "default"
    - cond_type: "attribute"
      resource_types:
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
        - "Pod"
        - "Service"
        - "ConfigMap"
        - "Secret"
      attribute: "metadata.namespace"
      operator: "not_equals"
      value: "kube-system"
    - cond_type: "attribute"
      resource_types:
        - "Deployment"
        - "StatefulSet"
        - "DaemonSet"
        - "Job"
        - "CronJob"
        - "Pod"
        - "Service"
        - "ConfigMap"
        - "Secret"
      attribute: "metadata.namespace"
      operator: "not_regex_match"
      value: "^kube-.*"